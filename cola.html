<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Inspired by The Drinkable Ad</title>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      background: #111;
      font-family: Arial, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    #gameContainer {
      position: relative;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: #222;
    }

    canvas {
      position: absolute;
      width: 100%;
      height: 100%;
    }

    .overlay {
      position: absolute;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      color: white;
      background: rgba(0,0,0,0.85);
      transition: opacity 0.8s ease;
      z-index: 10;
    }

    .overlay.hidden {
      opacity: 0;
      pointer-events: none;
    }

    h1, p {
      margin: 10px;
      text-align: center;
    }

    button {
      margin-top: 20px;
      padding: 12px 24px;
      border: none;
      border-radius: 12px;
      font-size: 18px;
      font-family: inherit;
      cursor: pointer;
      color: white;
    }

    .btn1 { background: #d32f2f; }
    .btn2 { background: #1976d2; }
    .btn3 { background: #388e3c; }
  </style>
</head>
<body>
  <div id="gameContainer">
    <canvas id="liquid"></canvas>

    <div id="startScreen" class="overlay">
      <h1>Inspired by The Drinkable Ad</h1>
      <p>Tilt or shake your phone to play.</p>
      <button id="startBtn" class="btn1">Tap to Begin</button>
    </div>

    <div id="endScreen" class="overlay hidden">
      <h1>Finished!</h1>
      <p id="scoreText"></p>
      <p id="bestText"></p>
      <button id="retryBtn" class="btn2">Retry</button>
    </div>
  </div>

  <script>
    const canvas = document.getElementById('liquid');
    const ctx = canvas.getContext('2d');
    let width, height;
    let liquidHeight, startTime, endTime;
    let bestTime = localStorage.getItem("bestTime") || null;
    let running = false;

    function resize() {
      width = canvas.width = window.innerWidth;
      height = canvas.height = window.innerHeight;
      liquidHeight = height;
    }
    window.addEventListener('resize', resize);
    resize();

    function drawLiquid() {
      ctx.clearRect(0, 0, width, height);

      // Gradient liquid
      let gradient = ctx.createLinearGradient(0, height, 0, height - liquidHeight);
      gradient.addColorStop(0, "#2b0a04"); // dark brown bottom
      gradient.addColorStop(0.7, "#6d1f0e"); // mid caramel
      gradient.addColorStop(1, "#b3471c"); // light with fizz at top

      ctx.fillStyle = gradient;
      ctx.fillRect(0, height - liquidHeight, width, liquidHeight);

      // Foam/fizz at the top
      if (liquidHeight > 0) {
        ctx.fillStyle = "rgba(255, 245, 230, 0.9)";
        ctx.beginPath();
        ctx.ellipse(width / 2, height - liquidHeight - 10, width / 2, 15, 0, 0, Math.PI * 2);
        ctx.fill();
      }
    }

    function update() {
      if (running) {
        if (liquidHeight > 0) {
          liquidHeight -= 1; // speed
        } else {
          finishGame();
        }
      }
      drawLiquid();
      requestAnimationFrame(update);
    }

    function startGame() {
      startTime = Date.now();
      liquidHeight = height;
      running = true;
      fadeOut(document.getElementById("startScreen"));
      fadeOut(document.getElementById("endScreen"));
    }

    function finishGame() {
      running = false;
      endTime = Date.now();
      let timeTaken = ((endTime - startTime) / 1000).toFixed(2);
      if (!bestTime || timeTaken < bestTime) {
        bestTime = timeTaken;
        localStorage.setItem("bestTime", bestTime);
      }
      document.getElementById("scoreText").textContent = `Time: ${timeTaken}s`;
      document.getElementById("bestText").textContent = `Best Time: ${bestTime}s`;
      fadeIn(document.getElementById("endScreen"));
    }

    function fadeIn(el) {
      el.classList.remove("hidden");
    }

    function fadeOut(el) {
      el.classList.add("hidden");
    }

    document.getElementById("startBtn").onclick = startGame;
    document.getElementById("retryBtn").onclick = startGame;

    update();
  </script>
</body>
</html>
